<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Paginación con Flask-Paginate</title>
    <link
      rel="shortcut icon"
      href="{{url_for('static', filename ='assets/imgs/favicon.png')}}"
      type="image/x-icon" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename ='./assets/css/custom_paginate.css') }}" />
  </head>
  <body>
    <div class="container mt-4">
      <div class="row justify-content-md-center">
        <h1 class="text-center mb-4">Listado de Países del Mundo DEMO</h1>
      </div>

      <div
        class="row justify-content-md-center"
        style="border: 1px solid yellow">
        <div class="table-responsive">
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th>Id</th>
                <th>Fecha registro</th>
              </tr>
            </thead>
            <tbody>
              {% for pais in paises %}
              <tr>
                <td>{{ pais.id }}</td>
                <td>{{ pais.fecha_registro }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <div class="row justify-content-md-center" style="border: 1px solid red">
        <div class="col-md-auto">
          <span>
            {{ pagination.info }}
            <hr />
          </span>
          {{ pagination.links }}
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      function actualizarTabla(pagina) {
        axios
          .get("/", { params: { page: pagina } })
          .then(function (response) {
            var tabla = $(response.data).find("table"); // seleccionar solo la tabla del nuevo contenido
            $("tbody").html(tabla.find("tbody").html()); // reemplazar solo el contenido de la tabla
          })
          .catch(function (error) {
            console.log("Error al obtener los datos de la página: " + error);
          });
      }

      $(document).on("click", ".pagination .page-link", function (event) {
        event.preventDefault();

        // Remover la clase active de todos los botones de la paginación
        $(".pagination .page-item").removeClass("active");

        // Activar la clase active en el botón de la página actual
        var pagina = $(this).attr("href").split("=")[1];
        $(".pagination .page-item a[href*='page=" + pagina + "']")
          .parent()
          .addClass("active");

        actualizarTabla(pagina);
      });
    </script>
  </body>
</html>
